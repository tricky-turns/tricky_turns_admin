<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Tricky Turns Admin Portal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div id="app">
    <!-- Sidebar Test -->
    <aside id="sidebar" class="sidebar hidden">
      <div class="sidebar-header">Tricky Turns Admin</div>
      <nav>
        <ul>
          <li><a href="#" data-section="modes">Game Modes</a></li>
          <li><a href="#" data-section="users">Users</a></li>
          <li><a href="#" data-section="leaderboard">Leaderboards</a></li>
          <li><a href="#" data-section="shop">Shop</a></li>
          <li><a href="#" data-section="contests">Contests</a></li>
          <li><a href="#" data-section="support">Support</a></li>
          <li><a href="#" data-section="analytics">Analytics</a></li>
          <li><a href="#" data-section="audit">Audit Log</a></li>
          <li><a href="#" id="logoutBtn" style="color: #ff4444">Logout</a></li>
        </ul>
      </nav>
    </aside>
    <!-- Main -->
    <main id="main-content">
      <!-- Login Screen -->
      <section id="login-section" class="centered">
        <form id="loginForm" autocomplete="off">
          <h2>Admin Login</h2>
          <input type="text" id="username" placeholder="Username" required />
          <input type="password" id="password" placeholder="Password" required />
          <button type="submit">Login</button>
          <div id="login-error" class="error"></div>
        </form>
      </section>
      <!-- Section Placeholders -->
      <section id="modes-section" class="admin-section hidden">
  <h2>Game Modes</h2>
  <form id="mode-add-form" class="mode-form">
    <input type="text" id="mode-add-name" placeholder="Name" required />
    <input type="text" id="mode-add-description" placeholder="Description" />
    <label>
      <input type="checkbox" id="mode-add-active" checked />
      Active
    </label>
    <button type="submit">Add Mode</button>
  </form>
  <div id="modes-table-container">
    <table id="modes-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
          <th>Active</th>
          <th>Created</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="modes-tbody"></tbody>
    </table>
  </div>
  <div id="modes-error" class="error"></div>
</section>

      
<section id="users-section" class="admin-section hidden">
  <h2>Users</h2>
  <form id="user-search-form" class="mode-form" style="margin-bottom:1.5em;">
    <input type="text" id="user-search" placeholder="Search username..." />
    <button type="submit">Search</button>
    <button type="button" id="user-search-reset">Reset</button>
  </form>
  <div id="users-table-container">
    <table id="users-table">
      <thead>
        <tr>
          <th>Username</th>
          <th>Created</th>
          <th>Last Login</th>
          <th>Banned</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="users-tbody"></tbody>
    </table>
  </div>
  <div id="users-error" class="error"></div>
</section>
      

<section id="leaderboard-section" class="admin-section hidden">
  <h2>Leaderboards</h2>
  <form id="leaderboard-filter-form" class="mode-form" style="margin-bottom:1.5em;">
    <label>
      Mode:
      <select id="leaderboard-mode-select"></select>
    </label>
    <input type="text" id="leaderboard-user-search" placeholder="Filter by username..." />
    <button type="submit">Filter</button>
    <button type="button" id="leaderboard-reset">Reset</button>
  </form>
  <div id="leaderboard-table-container">
    <table id="leaderboard-table">
      <thead>
        <tr>
          <th>Rank</th>
          <th>Username</th>
          <th>Score</th>
          <th>Achieved</th>
        </tr>
      </thead>
      <tbody id="leaderboard-tbody"></tbody>
    </table>
  </div>
  <div id="leaderboard-error" class="error"></div>
  <hr />
  <h3>User Score History</h3>
  <form id="score-history-form" class="mode-form" style="margin-bottom:1em;">
    <input type="text" id="history-user-search" placeholder="Username..." />
    <button type="submit">Show History</button>
  </form>
  <div id="score-history-table-container">
    <table id="score-history-table">
      <thead>
        <tr>
          <th>Date</th>
          <th>Mode ID</th>
          <th>Score</th>
          <th>Session ID</th>
        </tr>
      </thead>
      <tbody id="score-history-tbody"></tbody>
    </table>
  </div>
  <div id="score-history-error" class="error"></div>
</section>

<section id="shop-section" class="admin-section hidden">
  <h2>Shop Items</h2>
  <form id="shop-add-form" class="mode-form">
    <input type="text" id="shop-add-name" placeholder="Name" required />
    <input type="text" id="shop-add-description" placeholder="Description" />
    <input type="number" id="shop-add-price" placeholder="Price" step="0.01" min="0" required style="width:100px;" />
    <input type="text" id="shop-add-type" placeholder="Type (skin, boost...)" style="width:120px;" />
    <label>
      <input type="checkbox" id="shop-add-active" checked />
      Active
    </label>
    <button type="submit">Add Item</button>
  </form>
  <div id="shop-table-container">
    <table id="shop-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
          <th>Price</th>
          <th>Type</th>
          <th>Active</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="shop-tbody"></tbody>
    </table>
  </div>
  <div id="shop-error" class="error"></div>
  <hr />
  <h3>Purchases</h3>
  <form id="purchase-search-form" class="mode-form" style="margin-bottom:1.2em;">
    <input type="text" id="purchase-user-search" placeholder="Username..." />
    <button type="submit">Filter</button>
    <button type="button" id="purchase-search-reset">Reset</button>
  </form>
  <div id="purchases-table-container">
    <table id="purchases-table">
      <thead>
        <tr>
          <th>Username</th>
          <th>Item ID</th>
          <th>Amount</th>
          <th>Status</th>
          <th>Purchased At</th>
          <th>Tx Hash</th>
        </tr>
      </thead>
      <tbody id="purchases-tbody"></tbody>
    </table>
  </div>
  <div id="purchase-error" class="error"></div>
</section>
     


<section id="contests-section" class="admin-section hidden">
  <h2>Contests</h2>
  <form id="contest-add-form" class="mode-form">
    <input type="text" id="contest-add-name" placeholder="Name" required />
    <select id="contest-add-mode" required></select>
    <input type="datetime-local" id="contest-add-start" required />
    <input type="datetime-local" id="contest-add-end" required />
    <input type="number" id="contest-add-entry-fee" placeholder="Entry Fee" step="0.01" min="0" required style="width:90px;" />
    <input type="number" id="contest-add-reward" placeholder="Reward Pool" step="0.01" min="0" required style="width:90px;" />
    <input type="text" id="contest-add-status" placeholder="Status" value="active" required style="width:80px;" />
    <input type="text" id="contest-add-winner" placeholder="Winner (optional)" />
    <button type="submit">Add Contest</button>
  </form>
  <div id="contests-table-container">
    <table id="contests-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Mode</th>
          <th>Start</th>
          <th>End</th>
          <th>Entry Fee</th>
          <th>Reward Pool</th>
          <th>Status</th>
          <th>Winner</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="contests-tbody"></tbody>
    </table>
  </div>
  <div id="contests-error" class="error"></div>
  <hr />
  <h3>Contest Entries</h3>
  <form id="contest-entry-form" class="mode-form" style="margin-bottom:1.2em;">
    <select id="contest-entry-select"></select>
    <button type="submit">Show Entries</button>
  </form>
  <div id="contest-entries-table-container">
    <table id="contest-entries-table">
      <thead>
        <tr>
          <th>Username</th>
          <th>Score</th>
          <th>Session ID</th>
          <th>Entered At</th>
          <th>Prize</th>
        </tr>
      </thead>
      <tbody id="contest-entries-tbody"></tbody>
    </table>
  </div>
  <div id="contest-entries-error" class="error"></div>
</section>


      
<section id="support-section" class="admin-section hidden">
  <h2>Support Tickets</h2>
  <div id="support-table-container">
    <table id="support-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>User</th>
          <th>Subject</th>
          <th>Status</th>
          <th>Created</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="support-tbody"></tbody>
    </table>
  </div>
  <div id="support-error" class="error"></div>
  <div id="support-details" style="margin-top:2em;display:none;">
    <h3>Ticket Details</h3>
    <div><b>ID:</b> <span id="support-detail-id"></span></div>
    <div><b>User:</b> <span id="support-detail-user"></span></div>
    <div><b>Subject:</b> <span id="support-detail-subject"></span></div>
    <div><b>Status:</b> <span id="support-detail-status"></span></div>
    <div><b>Created:</b> <span id="support-detail-created"></span></div>
    <div><b>Message:</b></div>
    <div id="support-detail-message" style="white-space:pre-line;background:#f6f6f9;border-radius:6px;padding:1em;margin:0.7em 0;"></div>
    <button id="support-detail-close" style="margin-top:1em;">Close Ticket</button>
    <button id="support-detail-back" style="margin-top:1em;margin-left:1em;">Back</button>
    <div id="support-detail-error" class="error"></div>
  </div>
</section>


      
<section id="audit-section" class="admin-section hidden">
  <h2>Admin Audit Log</h2>
  <form id="audit-search-form" class="mode-form" style="margin-bottom:1.5em;">
    <input type="text" id="audit-search" placeholder="Filter by admin username..." />
    <button type="submit">Search</button>
    <button type="button" id="audit-search-reset">Reset</button>
  </form>
  <div id="audit-table-container">
    <table id="audit-table">
      <thead>
        <tr>
          <th>Time</th>
          <th>Admin</th>
          <th>Action</th>
          <th>Table</th>
          <th>Target ID</th>
          <th>Notes</th>
        </tr>
      </thead>
      <tbody id="audit-tbody"></tbody>
    </table>
  </div>
  <div id="audit-error" class="error"></div>
</section>


<section id="analytics-section" class="admin-section hidden">
  <h2>Analytics Dashboard</h2>
  <div id="analytics-summary" style="display:flex;gap:2em;flex-wrap:wrap;margin-bottom:1.5em;">
    <div class="stat-card">
      <div class="stat-title">DAU (24h)</div>
      <div class="stat-value" id="stat-dau">-</div>
    </div>
    <div class="stat-card">
      <div class="stat-title">WAU (7d)</div>
      <div class="stat-value" id="stat-wau">-</div>
    </div>
    <div class="stat-card">
      <div class="stat-title">MAU (30d)</div>
      <div class="stat-value" id="stat-mau">-</div>
    </div>
    <div class="stat-card">
      <div class="stat-title">Top Mode</div>
      <div class="stat-value" id="stat-top-mode">-</div>
    </div>
    <div class="stat-card">
      <div class="stat-title">Top Shop Item</div>
      <div class="stat-value" id="stat-top-item">-</div>
    </div>
    <div class="stat-card">
      <div class="stat-title">Purchases (30d)</div>
      <div class="stat-value" id="stat-purchases">-</div>
    </div>
    <div class="stat-card">
      <div class="stat-title">Support Tickets (30d)</div>
      <div class="stat-value" id="stat-support">-</div>
    </div>
  </div>
  <div>
    <h3>Sessions Per Day (Last 14d)</h3>
    <canvas id="sessions-chart" height="90"></canvas>
  </div>
  <div style="margin-top:2.5em;">
  <h3>New User Retention Cohorts</h3>
  <canvas id="retention-chart" height="110"></canvas>
  <div id="retention-error" class="error"></div>
</div>

  <div>
    <h3>Most Popular Modes</h3>
    <table id="analytics-modes-table" style="margin-top:0.7em;width:auto;">
      <thead><tr><th>Mode</th><th>Sessions</th></tr></thead>
      <tbody id="analytics-modes-tbody"></tbody>
    </table>
  </div>
  <div>
    <h3>Most Purchased Shop Items</h3>
    <table id="analytics-items-table" style="margin-top:0.7em;width:auto;">
      <thead><tr><th>Item</th><th>Purchases</th><th>Revenue</th></tr></thead>
      <tbody id="analytics-items-tbody"></tbody>
    </table>
  </div>
  <div id="analytics-error" class="error"></div>
</section>

    </main>
  </div>
  <script src="admin.js"></script>
</body>
</html>
